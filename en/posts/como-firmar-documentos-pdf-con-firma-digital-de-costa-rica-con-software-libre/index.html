<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cómo firmar documentos PDF con firma digital de Costa Rica con software libre | JáquerEspeis</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../../rss.xml">
<link rel="canonical" href="http://www.jaquerespeis.org/en/posts/como-firmar-documentos-pdf-con-firma-digital-de-costa-rica-con-software-libre/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="JáquerEspeis">
<link rel="prev" href="../como-autenticarse-en-el-modulo-de-firma-digital-de-la-ccss-en-gnulinux/" title="Cómo autenticarse en el Módulo de Firma Digital de la CCSS en GNU/Linux" type="text/html">
<link rel="next" href="../soluciones-modernas-para-usar-firma-digital-desde-la-web/" title="Soluciones modernas para usar firma digital desde la web" type="text/html">
<meta property="og:site_name" content="JáquerEspeis">
<meta property="og:title" content="Cómo firmar documentos PDF con firma digital de Costa Rica con softwar">
<meta property="og:url" content="http://www.jaquerespeis.org/en/posts/como-firmar-documentos-pdf-con-firma-digital-de-costa-rica-con-software-libre/">
<meta property="og:description" content="La Política de Formatos Oficiales de los Documentos Electrónicos Firmados Digitalmente de Costa Rica especifica el tipo de documentos y su formato de firma digital. En el caso de PDF se utiliza un est">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-11-07T21:11:42-06:00">
<meta property="article:tag" content="Firma digital">
<meta property="article:tag" content="Software libre">
<link rel="alternate" hreflang="es" href="../../../posts/como-firmar-documentos-pdf-con-firma-digital-de-costa-rica-con-software-libre/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://www.jaquerespeis.org/en/">

                <span id="blog-title">JáquerEspeis</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../../archive.html">Archivo</a>
                </li>
<li>
<a href="../../../categories/">Etiquetas</a>
                </li>
<li>
<a href="../../../rss.xml">Canal RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
            </li>
<li><a href="http://www.jaquerespeis.org/" rel="alternate" hreflang="es">Español</a></li>

                
                    
    <li>
    <a href="index.src.html" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post- h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Cómo firmar documentos PDF con firma digital de Costa Rica con software libre</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    JáquerEspeis
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2016-11-07T21:11:42-06:00" itemprop="datePublished" title="2016-11-07 21:11">2016-11-07 21:11</time></a></p>
            
        <p class="sourceline"><a href="index.src.html" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>La <a href="http://www.mifirmadigital.go.cr/wp-content/uploads/2016/03/DCFD-Poli%CC%81tica-de-Formato-Oficial-v1.0.pdf">Política de Formatos Oficiales de los Documentos Electrónicos Firmados Digitalmente</a> de Costa Rica especifica el tipo de documentos y su formato de firma digital. En el caso de PDF se utiliza un estándar especificado en Europa para firma digital avanzada (AdES) y en el caso de los PDF se llama PAdES. En el documento oficial enlazado previamente se muestra que tiene que soportar PAdES-LTV (permite la validación de forma longeva) y sugiere que se use el perfil Baseline. El asunto es que no hay mucho software libre en el mercado que permita la firma digital avanzada en PDF, sin embargo la propia Comisión Europea tiene un proyecto para ello (Digital Signature Services), que es un conjunto de librerías y herramientas en Java que permiten trabajar con firma digital con los estándares europeos, incluyendo soporte para PDF.</p>
<p>Hasta no hace mucho tiempo, una de las pocas implementaciones libres para trabajar con firma digital avanzada en PDF era iText, sin embargo este proyecto cambió de licencia y las condiciones de uso contradecían la propia licencia, además de presuntas incompatibilidades en contribuciones del código por parte de terceros que la hacían incompatible con la nueva licencia. Afortunadamente, el proyecto DSS (usando Apache PDFBox como alternativa a iText) permite firmar documentos PDF cumpliendo con la política de formatos oficiales nacional.</p>
<h2>Instalación en GNU/Linux</h2>
<p>Existe un firmador en formato independiente que funciona en el escritorio. Se puede descargar <a href="https://joinup.ec.europa.eu/sd-dss/webapp-demo/downloads/dss-app.zip">DSS standalone app package 5.0</a> (este es el más reciente en el momento de escribir esta entrada de blog).</p>
<p>Una vez descargado, descomprimir el tarball, contendrá dss-app.jar y un par de scripts para lanzar el jar de forma sencilla. El firmador que hay dentro del jar utiliza por defecto un servidor TSA europeo, para cambiarlo habrá que modificar un fichero que hay dentro del jar en la ruta spring/applicationContext.xml y buscar el texto: <code>http://tsa.belgium.be/connect</code> para reemplazarlo por el siguiente: <code>http://tsa.sinpe.fi.cr/tsahttp/</code> y guardarlo modificado con este cambio dentro del archivo jar (un archivo jar es un archivo zip realmente).</p>
<p>Para poder ejecutar este jar en GNU/Linux se necesita el entorno JRE de OpenJDK 8 y además OpenJFX 8 (JavaFX). En Ubuntu se puede instalar con <code>sudo apt install openjfx</code> y en Fedora mediante un repositorio COPR de terceros con <code>sudo dnf copr enable lenticularis/AVRConfig</code> y luego <code>sudo dnf install openjfx</code>.</p>
<p>Una vez instaladas las dependencias de Java, se puede ejecutar desde la terminal en la carpeta donde se haya descomprimido con <code>sh dss-run.sh</code> o bien con <code>java -jar dss-app.jar</code>.</p>
<p>Aparecerá una ventana como la siguiente:<br><img class="alignnone size-medium wp-image-63" src="https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-14-57-51.png" alt="Firmador DSS configurado" srcset="https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-14-57-51.png 650w, https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-14-57-51-300x179.png 300w" sizes="(max-width: 650px) 100vw, 650px"></p>
<h2>Firmado de un documento PDF</h2>
<p>En fichero a firmar (<code>File to sign</code>) se selecciona el documento PDF que se desea firmar digitalmente.</p>
<p>En formato de firma (<code>Signature format</code>) se debe elegir PAdES porque se trata de un PDF.</p>
<p>En PAdES solamente existe el formato envuelto (<code>Enveloped</code>), por lo que este campo lo selecciona automáticamente.</p>
<p>En el nivel (<code>Level</code>) se elige el nivel de perfil de PAdES. PAdES-BASELINE-LTA es el equivalente a PAdES-LTV.</p>
<p>En algoritmo de resumen hash encriptado (<code>Digest algorithm</code>) se recomienda que sea como mínimo de tipo SHA-2, en la imagen de ejemplo se ha seleccionado SHA-512.</p>
<p>En <code>Signature token API</code> se tiene que seleccionar <code>PKCS #11</code>, entonces se desplegará <code>PKCS #11 library</code> donde hay que especificar dónde está la librería del módulo de Firma Digital (libASEP11.so).</p>
<p>En contraseña (<code>Password</code>) se ingresa el PIN de la tarjeta de Firma Digital.</p>
<p>Cuando se presione sobre <code>Sign</code> se iniciará el proceso de firmado y tras unos segundos aparecerá una ventana para guardar el PDF generado en la ubicación que se desee.</p>
<p>Eso es todo. El documento PDF ya tiene una firma válida en el país.</p>
<h2>Demostración de documento válido generado</h2>
<p>Esta imagen muestra que la firma generada es válida en la aplicación Acrobat Reader DC:</p>
<p><img class="alignnone size-medium wp-image-64" src="https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-15-38-14.png" alt="Validando firma en Adobe Reader" srcset="https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-15-38-14.png 1024w, https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-15-38-14-300x190.png 300w, https://fran.cr/wp-content/uploads/2016/11/Captura-de-pantalla-de-2016-11-07-15-38-14-768x485.png 768w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>Existen formas de validar la firma del documento PDF con software libre (para no tener que usar Acrobat Reader DC como en este ejemplo), pero se explicará en próximas entradas de blog.</p>
<p>Aunque este firmador no tiene campo de estampa visible (“firma visible”), la política de documento oficial no indica que el documento requiera disponer este detalle visual en los PDF.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/firma-digital/" rel="tag">Firma digital</a></li>
            <li><a class="tag p-category" href="../../categories/software-libre/" rel="tag">Software libre</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../como-autenticarse-en-el-modulo-de-firma-digital-de-la-ccss-en-gnulinux/" rel="prev" title="Cómo autenticarse en el Módulo de Firma Digital de la CCSS en GNU/Linux">Previous post</a>
            </li>
            <li class="next">
                <a href="../soluciones-modernas-para-usar-firma-digital-desde-la-web/" rel="next" title="Soluciones modernas para usar firma digital desde la web">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>Publicado bajo una licencia <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>. - Creado con <a href="https://getnikola.com" rel="nofollow">Nikola</a>
            
        </footer>
</div>
</div>


            <script src="../../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
