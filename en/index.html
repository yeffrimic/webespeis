<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>JáquerEspeis</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../rss.xml">
<link rel="canonical" href="http://www.jaquerespeis.org/en/">
<link rel="next" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://www.jaquerespeis.org/en/">

                <span id="blog-title">JáquerEspeis</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../archive.html">Archivo</a>
                </li>
<li>
<a href="../categories/">Etiquetas</a>
                </li>
<li>
<a href="../rss.xml">Canal RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
            </li>
<li><a href="http://www.jaquerespeis.org/" rel="alternate" hreflang="es">Español</a></li>

                
                    
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/postsholamundo-ethereum/" class="u-url">HolaMundo con ethereum</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/postsholamundo-ethereum/" rel="bookmark"><time class="published dt-published" datetime="2017-07-19T05:07:00-06:00" title="2017-07-19 05:07">2017-07-19 05:07</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<h2>Lista de herramientas</h2>
<ul>
<li>testRPC</li>
<li>nvm</li>
<li>web3</li>
<li>geth</li>
<li>solc</li>
<li>web3</li>
</ul>
<h2>Instalación</h2>
<h3>Linux</h3>
<p>Los siguientes pasos muestras como instalar las herramientas necesarias en Ubuntu 17.04</p>
<pre class="code literal-block"><span></span>curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash
nvm ls-remote
nvm install &lt;la ultima LTS&gt;
npm install -g ethereumjs-testrpc
npm install solc
npm install web3
</pre>


<h3>Mac</h3>
<p>Para instalar nvm es necesario tener <a href="https://brew.sh/">brew</a></p>
<pre class="code literal-block"><span></span>brew install nvm
nvm ls-remote
nvm install &lt;la ultima LTS&gt;
npm install -g ethereumjs-testrpc
npm install solc
npm install web3
</pre>


<h2>Desarrollo</h2>
<p>Con el editor preferido, escribir el contrato, para esto se va a utilizar el lenguage <a href="https://solidity.readthedocs.io/en/develop/"><strong>solidity</strong></a>, sin embargo existen otras opciones como <a href="https://github.com/ethereum/wiki/wiki/Serpent"><strong>serpent</strong></a>.</p>
<p>Para compilar el contrato vamos a utilizar el comando <code>solc --bin --optimize &lt;archivo.sol&gt;</code></p>
<p>Escribit el siguiente contrato en un archivo llamado Voting.sol</p>
<pre class="code literal-block"><span></span>pragma solidity ^0.4.11;
// We have to specify what version of compiler this code will compile with

contract Voting {
  /* mapping field below is equivalent to an associative array or hash.
  The key of the mapping is candidate name stored as type bytes32 and value is
  an unsigned integer to store the vote count
  */

  mapping (bytes32 =&gt; uint8) public votesReceived;

  /* Solidity doesn't let you pass in an array of strings in the constructor (yet).
  We will use an array of bytes32 instead to store the list of candidates
  */

  bytes32[] public candidateList;

  /* This is the constructor which will be called once when you
  deploy the contract to the blockchain. When we deploy the contract,
  we will pass an array of candidates who will be contesting in the election
  */
  function Voting(bytes32[] candidateNames) {
    candidateList = candidateNames;
  }

  // This function returns the total votes a candidate has received so far
  function totalVotesFor(bytes32 candidate) returns (uint8) {
    if (validCandidate(candidate) == false) throw;
    return votesReceived[candidate];
  }

  // This function increments the vote count for the specified candidate. This
  // is equivalent to casting a vote
  function voteForCandidate(bytes32 candidate) {
    if (validCandidate(candidate) == false) throw;
    votesReceived[candidate] += 1;
  }

  function validCandidate(bytes32 candidate) returns (bool) {
    for(uint i = 0; i &lt; candidateList.length; i++) {
      if (candidateList[i] == candidate) {
        return true;
      }
    }
    return false;
  }
}
</pre>


<h3>Pasos para desplegar el contrato</h3>
<p><em>Ejecutar node</em></p>
<p>Mientras se ejecutan los comandos, se puede ver su salida y analizarla.</p>
<pre class="code literal-block"><span></span><span class="nx">Web3</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'web3'</span><span class="p">)</span>
<span class="nx">web3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Web3</span><span class="p">(</span><span class="k">new</span> <span class="nx">Web3</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">HttpProvider</span><span class="p">(</span><span class="s2">"http://localhost:8545"</span><span class="p">));</span>
</pre>


<p>Listar las cuentas existentes en la red</p>
<pre class="code literal-block"><span></span><span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">accounts</span>
</pre>


<p>Compilar el código </p>
<pre class="code literal-block"><span></span><span class="nx">code</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">'Voting.sol'</span><span class="p">).</span><span class="nx">toString</span><span class="p">()</span>
<span class="nx">solc</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'solc'</span><span class="p">)</span>
<span class="nx">compiledCode</span> <span class="o">=</span> <span class="nx">solc</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span>
</pre>


<pre class="code literal-block"><span></span><span class="nx">abiDefinition</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">compiledCode</span><span class="p">.</span><span class="nx">contracts</span><span class="p">[</span><span class="s1">':Voting'</span><span class="p">].</span><span class="kr">interface</span><span class="p">)</span>
<span class="nx">VotingContract</span> <span class="o">=</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">contract</span><span class="p">(</span><span class="nx">abiDefinition</span><span class="p">)</span>
<span class="nx">byteCode</span> <span class="o">=</span> <span class="nx">compiledCode</span><span class="p">.</span><span class="nx">contracts</span><span class="p">[</span><span class="s1">':Voting'</span><span class="p">].</span><span class="nx">bytecode</span>
<span class="nx">deployedContract</span> <span class="o">=</span> <span class="nx">VotingContract</span><span class="p">.</span><span class="k">new</span><span class="p">([</span><span class="s1">'Rama'</span><span class="p">,</span><span class="s1">'Nick'</span><span class="p">,</span><span class="s1">'Jose'</span><span class="p">],{</span><span class="nx">data</span><span class="o">:</span> <span class="nx">byteCode</span><span class="p">,</span> <span class="nx">from</span><span class="o">:</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">gas</span><span class="o">:</span> <span class="mi">4700000</span><span class="p">})</span>
<span class="nx">deployedContract</span><span class="p">.</span><span class="nx">address</span>
<span class="nx">contractInstance</span> <span class="o">=</span> <span class="nx">VotingContract</span><span class="p">.</span><span class="nx">at</span><span class="p">(</span><span class="nx">deployedContract</span><span class="p">.</span><span class="nx">address</span><span class="p">)</span>
</pre>


<pre class="code literal-block"><span></span><span class="o">&gt;</span> <span class="nx">contractInstance</span><span class="p">.</span><span class="nx">totalVotesFor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'Rama'</span><span class="p">)</span>

<span class="p">{</span> <span class="p">[</span><span class="nb">String</span><span class="o">:</span> <span class="s1">'0'</span><span class="p">]</span> <span class="nx">s</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">e</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">}</span>

<span class="o">&gt;</span> <span class="nx">contractInstance</span><span class="p">.</span><span class="nx">voteForCandidate</span><span class="p">(</span><span class="s1">'Rama'</span><span class="p">,</span> <span class="p">{</span><span class="nx">from</span><span class="o">:</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>

<span class="s1">'0xdedc7ae544c3dde74ab5a0b07422c5a51b5240603d31074f5b75c0ebc786bf53'</span>

<span class="o">&gt;</span> <span class="nx">contractInstance</span><span class="p">.</span><span class="nx">voteForCandidate</span><span class="p">(</span><span class="s1">'Rama'</span><span class="p">,</span> <span class="p">{</span><span class="nx">from</span><span class="o">:</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>

<span class="s1">'0x02c054d238038d68b65d55770fabfca592a5cf6590229ab91bbe7cd72da46de9'</span>

<span class="o">&gt;</span> <span class="nx">contractInstance</span><span class="p">.</span><span class="nx">voteForCandidate</span><span class="p">(</span><span class="s1">'Rama'</span><span class="p">,</span> <span class="p">{</span><span class="nx">from</span><span class="o">:</span> <span class="nx">web3</span><span class="p">.</span><span class="nx">eth</span><span class="p">.</span><span class="nx">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>

<span class="s1">'0x3da069a09577514f2baaa11bc3015a16edf26aad28dffbcd126bde2e71f2b76f'</span>

<span class="o">&gt;</span> <span class="nx">contractInstance</span><span class="p">.</span><span class="nx">totalVotesFor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'Rama'</span><span class="p">).</span><span class="nx">toLocaleString</span><span class="p">()</span>

<span class="s1">'3'</span>
</pre>


<h2>Opcodes de la EVM</h2>
<h3>0s: Stop and Arithmetic Operations</h3>
<pre class="code literal-block"><span></span>0x00    STOP        Halts execution
0x01    ADD         Addition operation
0x02    MUL         Multiplication operation
0x03    SUB         Subtraction operation
0x04    DIV         Integer division operation
0x05    SDIV        Signed integer
0x06    MOD         Modulo
0x07    SMOD        Signed modulo
0x08    ADDMOD      Modulo
0x09    MULMOD      Modulo
0x0a    EXP         Exponential operation
0x0b    SIGNEXTEND  Extend length of two's complement signed integer
</pre>


<h3>10s: Comparison &amp; Bitwise Logic Operations</h3>
<pre class="code literal-block"><span></span>0x10    LT      Lesser-than comparison
0x11    GT      Greater-than comparison
0x12    SLT     Signed less-than comparison
0x13    SGT     Signed greater-than comparison
0x14    EQ      Equality  comparison
0x15    ISZERO  Simple not operator
0x16    AND     Bitwise AND operation
0x17    OR      Bitwise OR operation
0x18    XOR     Bitwise XOR operation
0x19    NOT     Bitwise NOT operation
0x1a    BYTE    Retrieve single byte from word
</pre>


<h3>20s: SHA3</h3>
<pre class="code literal-block"><span></span>0x20    SHA3    Compute Keccak-256 hash
</pre>


<h3>30s: Environmental Information</h3>
<pre class="code literal-block"><span></span>0x30    ADDRESS         Get address of currently executing account
0x31    BALANCE         Get balance of the given account
0x32    ORIGIN          Get execution origination address
0x33    CALLER          Get caller address. This is the address of the account that is directly responsible for this execution
0x34    CALLVALUE       Get deposited value by the instruction/transaction responsible for this execution
0x35    CALLDATALOAD    Get input data of current environment
0x36    CALLDATASIZE    Get size of input data in current environment
0x37    CALLDATACOPY    Copy input data in current environment to memory This pertains to the input data passed with the message call instruction or transaction
0x38    CODESIZE        Get size of code running in current environment
0x39    CODECOPY        Copy code running in current environment to memory
0x3a    GASPRICE        Get price of gas in current environment
0x3b    EXTCODESIZE     Get size of an account's code
0x3c    EXTCODECOPY     Copy an account's code to memory
</pre>


<h3>40s: Block Information</h3>
<pre class="code literal-block"><span></span>0x40    BLOCKHASH   Get the hash of one of the 256 most recent complete blocks
0x41    COINBASE    Get the block's beneficiary address
0x42    TIMESTAMP   Get the block's timestamp
0x43    NUMBER      Get the block's number
0x44    DIFFICULTY  Get the block's difficulty
0x45    GASLIMIT    Get the block's gas limit
</pre>


<h3>50s Stack, Memory, Storage and Flow Operations</h3>
<pre class="code literal-block"><span></span>0x50    POP         Remove item from stack
0x51    MLOAD       Load word from memory
0x52    MSTORE      Save word to memory
0x53    MSTORE8     Save byte to memory
0x54    SLOAD       Load word from storage
0x55    SSTORE      Save word to storage
0x56    JUMP        Alter the program counter
0x57    JUMPI       Conditionally alter the program counter
0x58    PC          Get the value of the program counter prior to the increment
0x59    MSIZE       Get the size of active memory in bytes
0x5a    GAS         Get the amount of available gas, including the corresponding reduction
0x5b    JUMPDEST    Mark a valid destination for jumps
</pre>


<h3>60s &amp; 70s: Push Operations</h3>
<pre class="code literal-block"><span></span>0x60    PUSH1   Place 1 byte item on stack
0x61    PUSH2   Place 2-byte item on stack
…
0x7f    PUSH32  Place 32-byte (full word) item on stack
</pre>


<h3>80s: Duplication Operations</h3>
<pre class="code literal-block"><span></span>0x80    DUP1    Duplicate 1st stack item
0x81    DUP2    Duplicate 2nd stack item
…
0x8f    DUP16   Duplicate 16th stack item
</pre>


<h3>90s: Exchange Operations</h3>
<pre class="code literal-block"><span></span>0x90    SWAP1   Exchange 1st and 2nd stack items
0x91    SWAP2   Exchange 1st and 3rd stack items
…   …
0x9f    SWAP16  Exchange 1st and 17th stack items
</pre>


<h3>a0s: Logging Operations</h3>
<pre class="code literal-block"><span></span>0xa0    LOG0    Append log record with no topics
0xa1    LOG1    Append log record with one topic
…   …
0xa4    LOG4    Append log record with four topics
</pre>


<h3>f0s: System operations</h3>
<pre class="code literal-block"><span></span>0xf0    CREATE          Create a new account with associated code
0xf1    CALL            Message-call into an account
0xf2    CALLCODE        Message-call into this account with alternative account's code
0xf3    RETURN          Halt execution returning output data
0xf4    DELEGATECALL    Message-call into this account with an alternative account's code, but persisting the current values for `sender` and `value`
</pre>


<h3>Halt Execution, Mark for deletion</h3>
<pre class="code literal-block"><span></span>0xff    SELFDESTRUCT    Halt execution and register account for later deletion
</pre>


<h2>Referencias</h2>
<ul>
<li>https://github.com/creationix/nvm</li>
<li>https://github.com/ethereumjs/testrpc</li>
<li>https://en.wikipedia.org/wiki/Remote_procedure_call</li>
<li>http://ethdocs.org/en/latest/network/test-networks.html</li>
<li>https://medium.com/@doart3/ethereum-dapps-without-truffle-compile-deploy-use-it-e6daeefcf919</li>
<li>https://medium.com/@mvmurthy/full-stack-hello-world-voting-ethereum-dapp-tutorial-part-1-40d2d0d807c2</li>
<li>https://github.com/ethereum/yellowpaper</li>
</ul>
<h2>Notas</h2>
<p>testrpc -n5</p>
</div>
    </div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/esblogerrbot-snap/" class="u-url">An errbot snap for simplified chatops</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/esblogerrbot-snap/" rel="bookmark"><time class="published dt-published" datetime="2017-07-12T04:07:00-06:00" title="2017-07-12 04:07">2017-07-12 04:07</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>I'm a Quality Assurance Engineer. A big part of my job is to find problems,
then make sure that they are fixed and <em>automated</em> so they don't regress. If I
do my job well, then our process will identify new and potential problems early
<em>without manual intervention</em> from anybody in the team. It's like trying to
automate myself, everyday, until I'm no longer needed and have to jump to
another project.</p>
<p>However, as we work in the project, it's unavoidable that many small manual
tasks accumulate on my hands. This happens because I set up the continuous
integration infrastructure, so I'm the one who knows more about it and have
easier access, or because I'm the one who requested access to the build farm
so I'm the one with the password, or because I configured the staging
environment and I'm the only one who knows the details. This is a great way
to achieve job security, but it doesn't lead us to higher quality. It's a job
half done, and it's terribly boring to be a bottleneck and a silo of
information about testing and the release process. All of these tasks should be
shared by the whole team, as with all the other tasks in the project.</p>
<p>There are two problems. First, most of these tasks involve delicate credentials
that shouldn't be freely shared with everybody. Second, even if the task itself
is simple and quick to execute, it's not very simple to document how to set up
the environment to be able to execute them, nor how to make sure that the right
task is executed in the right moment.</p>
<p>Chatops is how I like to solve all of this. The idea is that every task that
requires manual intervention is implemented in a script that can be executed by
a bot. This bot joins the communication channel where the entire team is
present, and it will execute the tasks and report about their results as a
response to external events that happen somewhere in the project
infrastructure, or as a response to the direct request of a team member in the
channel. The credentials are kept safe, they only have to be shared with the
bot and the permissions can be handled with access control lists or membership
to the channel. And the operative knowledge is shared with all the team,
because they are all listening in the same channel with the bot. This means
that anybody can execute the tasks, and the bot assists them to make it simple.</p>
<p>In snapcraft we started writing our bot not so long ago. It's called snappy-m-o
(<a href="http://pixar.wikia.com/wiki/M-O">Microbe Obliterator</a>), and it's written
in python with <a href="http://errbot.io/">errbot</a>. We, of course, packaged it as a
snap so we have automated delivery every time we change it's source code, and
the bot is also autoupdated in the server, so in the chat we are always
interacting with the latest and greatest.</p>
<p>Let me show you how we started it, in case you want to get your own. But let's
call this one Baymax, and let's make a virtual environment with errbot, to
experiment.</p>
<p><a href="https://upload.wikimedia.org/wikipedia/en/2/2c/Baymax_from_Disney%27s_Big_Hero_6.png"><img alt="drawing of the Baymax bot" src="https://upload.wikimedia.org/wikipedia/en/2/2c/Baymax_from_Disney%27s_Big_Hero_6.png"></a></p>
<pre class="code literal-block"><span></span>$ mkdir -p ~/workspace/baymax
$ <span class="nb">cd</span> ~/workspace/baymax
$ sudo apt install python3-venv
$ python3 -m venv .venv
$ <span class="nb">source</span> .venv/bin/activate
$ pip install errbot
$ errbot --init
</pre>


<p>The last command will initialize this bot with a super simple plugin, and
will configure it to work in text mode. This means that the bot won't be
listening on any channel, you can just interact with it through the command
line (the ops, without the chat). Let's try it:</p>
<pre class="code literal-block"><span></span>$ errbot
<span class="o">[</span>...<span class="o">]</span>
&gt;&gt;&gt; !help
All commands
<span class="o">[</span>...<span class="o">]</span>
!tryme - Execute to check <span class="k">if</span> Errbot responds to command.
<span class="o">[</span>...<span class="o">]</span>
&gt;&gt;&gt; !tryme
It works !
&gt;&gt;&gt; !shutdown --confirm
</pre>


<p><code>tryme</code> is the command provided by the example plugin that <code>errbot --init</code>
created. Take a look at the file <code>plugins/err-example/example.py</code>, errbot is
just lovely. In order to define your own plugin you will just need a class that
inherits from <code>errbot.BotPlugin</code>, and the commands are methods decorated with
<code>@errbot.botcmd</code>. I won't dig into how to write plugins, because they have an
amazing
<a href="http://errbot.io/en/latest/user_guide/plugin_development/index.html">documentation about Plugin development</a>.
You can also read the plugins we have in our snappy-m-o, one for
<a href="https://github.com/elopio/snappy-m-o/blob/master/plugins/autopkgtest_github/autopkgtest_github.py">triggering autopkgtests on GitHub pull requests</a>,
and the other for
<a href="https://github.com/elopio/snappy-m-o/blob/master/plugins/snapcraft_github/snapcraft_github.py">subscribing to the results of the pull requests tests</a>.</p>
<p>Let's change the config of Baymax to put it in an IRC chat:</p>
<pre class="code literal-block"><span></span>$ pip install irc
</pre>


<p>And in the <code>config.py</code> file, set the following values:</p>
<pre class="code literal-block"><span></span>BACKEND = 'IRC'
BOT_IDENTITY = {
    'nickname' : 'baymax-elopio',  # Nicknames need to be unique, so append your own.
                                   # Remember to replace 'elopio' with your nick everywhere
                                   # from now on.
    'server' : 'irc.freenode.net',
}
CHATROOM_PRESENCE = ('#snappy',)
</pre>


<p>Run it again with the errbot command, but this time join the #snappy channel
in irc.freenode.net, and write in there <code>!tryme</code>. It works ! :)</p>
<p><a href="https://archive.org/download/elopio-screenshots2/errbot/errbot-snap.png"><img alt="screenshot of errbot on IRC" src="https://archive.org/download/elopio-screenshots2/errbot/errbot-snap.png"></a></p>
<p>So, this is very simple, but let's package it now to start with the good
practice of continuous delivery before it gets more complicated. As usual, it
just requires a <code>snapcraft.yaml</code> file with all the packaging info and metadata:</p>
<pre class="code literal-block"><span></span><span class="n">name</span><span class="o">:</span> <span class="n">baymax</span><span class="o">-</span><span class="n">elopio</span>
<span class="n">version</span><span class="o">:</span> <span class="s1">'0.1-dev'</span>
<span class="n">summary</span><span class="o">:</span> <span class="n">A</span> <span class="n">test</span> <span class="n">bot</span> <span class="k">with</span> <span class="n">errbot</span><span class="o">.</span>
<span class="n">description</span><span class="o">:</span> <span class="n">Chat</span> <span class="n">ops</span> <span class="n">bot</span> <span class="k">for</span> <span class="n">my</span> <span class="n">team</span><span class="o">.</span>
<span class="n">grade</span><span class="o">:</span> <span class="n">stable</span>
<span class="n">confinement</span><span class="o">:</span> <span class="n">strict</span>

<span class="n">apps</span><span class="o">:</span>
  <span class="n">baymax</span><span class="o">-</span><span class="n">elopio</span><span class="o">:</span>
    <span class="n">command</span><span class="o">:</span> <span class="n">env</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="n">C</span><span class="o">.</span><span class="na">UTF</span><span class="o">-</span><span class="mi">8</span> <span class="n">errbot</span> <span class="o">-</span><span class="n">c</span> <span class="n">$SNAP</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="na">py</span>
    <span class="n">plugs</span><span class="o">:</span> <span class="o">[</span><span class="n">home</span><span class="o">,</span> <span class="n">network</span><span class="o">,</span> <span class="n">network</span><span class="o">-</span><span class="n">bind</span><span class="o">]</span>

<span class="n">parts</span><span class="o">:</span>
  <span class="n">errbot</span><span class="o">:</span>
    <span class="n">plugin</span><span class="o">:</span> <span class="n">python</span>
    <span class="n">python</span><span class="o">-</span><span class="n">packages</span><span class="o">:</span> <span class="o">[</span><span class="n">errbot</span><span class="o">,</span> <span class="n">irc</span><span class="o">]</span>
  <span class="n">baymax</span><span class="o">:</span>
    <span class="n">source</span><span class="o">:</span> <span class="o">.</span>
    <span class="n">plugin</span><span class="o">:</span> <span class="n">dump</span>
    <span class="n">stage</span><span class="o">:</span>
      <span class="o">-</span> <span class="n">config</span><span class="o">.</span><span class="na">py</span>
      <span class="o">-</span> <span class="n">plugins</span>
    <span class="n">after</span><span class="o">:</span> <span class="o">[</span><span class="n">errbot</span><span class="o">]</span>
</pre>


<p>And we need to change a few more values in <code>config.py</code> to make sure that the
bot is relocatable, that we can run it in the isolated snap environment, and
that we can add plugins after it has been installed:</p>
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">BOT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'SNAP_USER_DATA'</span><span class="p">)</span>
<span class="n">BOT_EXTRA_PLUGIN_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'SNAP'</span><span class="p">),</span> <span class="s1">'plugins'</span><span class="p">)</span>
<span class="n">BOT_LOG_FILE</span> <span class="o">=</span> <span class="n">BOT_DATA_DIR</span> <span class="o">+</span> <span class="s1">'/err.log'</span>
</pre>


<p>One final try, this time from the snap:</p>
<pre class="code literal-block"><span></span>$ sudo apt install snapcraft
$ snapcraft
$ sudo snap install baymax*.snap --dangerous
$ baymax-elopio
</pre>


<p>And go back to IRC to check.</p>
<p>Last thing would be to push the source code we have just written to a GitHub
repo, and enable the continuous delivery in build.snapcraft.io. Go to your
server and install the bot with <code>sudo snap install baymax-elopio --edge</code>.
Now everytime somebody from your team makes a change in the master repo in
GitHub, the bot in your server will be automatically updated to get those
changes within a few hours without any work from your side.</p>
<p>If you are into chatops, make sure that every time you do a manual task, you
also plan for some time to turn that task into a script that can be executed
by your bot. And get ready to enjoy tons and tons of free time, or just keep
going through those <a href="https://bugs.launchpad.net/snapcraft">400 open bugs</a>,
whichever you prefer :)</p>
</div>
    </div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/esbloggobot-snaps/" class="u-url">Deploy to all SBCs with Gobot and a single snap package</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/esbloggobot-snaps/" rel="bookmark"><time class="published dt-published" datetime="2017-07-11T14:07:00-06:00" title="2017-07-11 14:07">2017-07-11 14:07</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>I love playing with my prototyping boards. Here at Ubuntu we are designing
the <a href="https://developer.ubuntu.com/core/get-started">core operating system</a>
to support every <a href="https://en.wikipedia.org/wiki/Single-board_computer">single-board computer</a>,
and keep it safe, updated and simple. I've learned a lot about physical
computing, but I always have a big problem when my prototype is done, and I
want to deploy it. I am working with a
<a href="https://en.wikipedia.org/wiki/Raspberry_Pi">Raspberry Pi</a>, a
<a href="http://www.96boards.org/product/dragonboard410c/">DragonBoard</a>, and a
<a href="https://en.wikipedia.org/wiki/BeagleBoard#BeagleBone_Black">BeagleBone</a>. They
are all very different, with different architectures, different pins, onboard
capabilities and peripherals, and they can have different operating systems.
When I started learning about this, I had to write 3 programs that were very
different, if I wanted to try my prototype in all my boards.</p>
<p><a href="https://archive.org/download/snappy-gobot/20170710_174806.jpg"><img alt="picture of the three different SBCs" src="https://archive.org/download/snappy-gobot/20170710_174806.jpg"></a></p>
<p>Then I found <a href="https://gobot.io/">Gobot</a>, a framework for robotics and IoT that
supports my three boards, and many more. With the added benefit that you can
write all the software in the lovely and clean Go language. The Ubuntu store
supports all their architectures too, and
<a href="https://www.youtube.com/watch?v=b2x6mumSrpw">packaging Go projects with snapcraft</a>
is super simple. So we can combine all of this to make a single snap package
that with the help of Gobot will work on every board, and deploy it to all the
users of these boards through the snaps store.</p>
<p>Let's dig into the code with a very simple example to blink an LED, first
for the Raspberry PI only.</p>
<pre class="code literal-block"><span></span><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s2">"time"</span>

  <span class="s2">"gobot.io/x/gobot"</span>
  <span class="s2">"gobot.io/x/gobot/drivers/gpio"</span>
  <span class="s2">"gobot.io/x/gobot/platforms/raspi"</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">adaptor</span> <span class="p">:</span><span class="o">=</span> <span class="n">raspi</span><span class="o">.</span><span class="n">NewAdaptor</span><span class="p">()</span>
  <span class="n">led</span> <span class="p">:</span><span class="o">=</span> <span class="n">gpio</span><span class="o">.</span><span class="n">NewLedDriver</span><span class="p">(</span><span class="n">adaptor</span><span class="p">,</span> <span class="s2">"7"</span><span class="p">)</span>

  <span class="n">work</span> <span class="p">:</span><span class="o">=</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">gobot</span><span class="o">.</span><span class="n">Every</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">,</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
      <span class="n">led</span><span class="o">.</span><span class="n">Toggle</span><span class="p">()</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="n">robot</span> <span class="p">:</span><span class="o">=</span> <span class="n">gobot</span><span class="o">.</span><span class="n">NewRobot</span><span class="p">(</span><span class="s2">"snapbot"</span><span class="p">,</span>
    <span class="p">[]</span><span class="n">gobot</span><span class="o">.</span><span class="n">Connection</span><span class="p">{</span><span class="n">adaptor</span><span class="p">},</span>
    <span class="p">[]</span><span class="n">gobot</span><span class="o">.</span><span class="n">Device</span><span class="p">{</span><span class="n">led</span><span class="p">},</span>
    <span class="n">work</span><span class="p">,</span>
  <span class="p">)</span>

  <span class="n">robot</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>
<span class="p">}</span>
</pre>


<p>In there you will see some of the Gobot concepts. There's an adaptor for the
board, a driver for the specific device (in this case the LED), and a robot
to control everything. In this program, there are only two things specific to
the Raspberry Pi: the adaptor and the name of the GPIO pin (<code>"7"</code>).</p>
<p><a href="https://ia801502.us.archive.org/32/items/snappy-gobot/20170710_214428.ogv"><img alt="picture of the Raspberry Pi prototype" src="https://ia601502.us.archive.org/32/items/snappy-gobot/20170710_214439.jpg"></a></p>
<p>It works nicely in one of the boards, but let's extend the code a little to
support the other two.</p>
<pre class="code literal-block"><span></span><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s2">"log"</span>
  <span class="s2">"os/exec"</span>
  <span class="s2">"strings"</span>
  <span class="s2">"time"</span>

  <span class="s2">"gobot.io/x/gobot"</span>
  <span class="s2">"gobot.io/x/gobot/drivers/gpio"</span>
  <span class="s2">"gobot.io/x/gobot/platforms/beaglebone"</span>
  <span class="s2">"gobot.io/x/gobot/platforms/dragonboard"</span>
  <span class="s2">"gobot.io/x/gobot/platforms/raspi"</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">out</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span><span class="o">=</span> <span class="k">exec</span><span class="o">.</span><span class="n">Command</span><span class="p">(</span><span class="s2">"uname"</span><span class="p">,</span> <span class="s2">"-r"</span><span class="p">)</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
    <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">var</span> <span class="n">adaptor</span> <span class="n">gobot</span><span class="o">.</span><span class="n">Adaptor</span>
  <span class="n">var</span> <span class="n">pin</span> <span class="n">string</span>
  <span class="n">kernelRelease</span> <span class="p">:</span><span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">strings</span><span class="o">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">kernelRelease</span><span class="p">,</span> <span class="s2">"raspi2"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">adaptor</span> <span class="o">=</span> <span class="n">raspi</span><span class="o">.</span><span class="n">NewAdaptor</span><span class="p">()</span>
    <span class="n">pin</span> <span class="o">=</span> <span class="s2">"7"</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">strings</span><span class="o">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">kernelRelease</span><span class="p">,</span> <span class="s2">"snapdragon"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">adaptor</span> <span class="o">=</span> <span class="n">dragonboard</span><span class="o">.</span><span class="n">NewAdaptor</span><span class="p">()</span>
    <span class="n">pin</span> <span class="o">=</span> <span class="s2">"GPIO_A"</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">adaptor</span> <span class="o">=</span> <span class="n">beaglebone</span><span class="o">.</span><span class="n">NewAdaptor</span><span class="p">()</span>
    <span class="n">pin</span> <span class="o">=</span> <span class="s2">"P8_7"</span>
  <span class="p">}</span>
  <span class="n">digitalWriter</span><span class="p">,</span> <span class="n">ok</span> <span class="p">:</span><span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="p">(</span><span class="n">gpio</span><span class="o">.</span><span class="n">DigitalWriter</span><span class="p">)</span>
  <span class="k">if</span> <span class="err">!</span><span class="n">ok</span> <span class="p">{</span>
    <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="s2">"Invalid adaptor"</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">led</span> <span class="p">:</span><span class="o">=</span> <span class="n">gpio</span><span class="o">.</span><span class="n">NewLedDriver</span><span class="p">(</span><span class="n">digitalWriter</span><span class="p">,</span> <span class="n">pin</span><span class="p">)</span>

  <span class="n">work</span> <span class="p">:</span><span class="o">=</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">gobot</span><span class="o">.</span><span class="n">Every</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">,</span> <span class="n">func</span><span class="p">()</span> <span class="p">{</span>
      <span class="n">led</span><span class="o">.</span><span class="n">Toggle</span><span class="p">()</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="n">robot</span> <span class="p">:</span><span class="o">=</span> <span class="n">gobot</span><span class="o">.</span><span class="n">NewRobot</span><span class="p">(</span><span class="s2">"snapbot"</span><span class="p">,</span>
    <span class="p">[]</span><span class="n">gobot</span><span class="o">.</span><span class="n">Connection</span><span class="p">{</span><span class="n">adaptor</span><span class="p">},</span>
    <span class="p">[]</span><span class="n">gobot</span><span class="o">.</span><span class="n">Device</span><span class="p">{</span><span class="n">led</span><span class="p">},</span>
    <span class="n">work</span><span class="p">,</span>
  <span class="p">)</span>

  <span class="n">robot</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>
<span class="p">}</span>
</pre>


<p>We are basically adding in there a block to select the right adaptor and pin,
depending on which board the code is running. Now we can compile this program,
throw the binary in the board, and give it a try.</p>
<p><a href="https://ia801502.us.archive.org/32/items/snappy-gobot/20170710_212605.ogv"><img alt="picture of the Dragonboard prototype" src="https://ia801502.us.archive.org/32/items/snappy-gobot/20170710_212602.jpg"></a></p>
<p>But we can do better. If we package this in a snap, anybody with one of the
boards and an operating system that supports snaps can easily install it. We
also open the door to
<a href="https://build.snapcraft.io">continuous delivery</a> and
<a href="http://elopio.net/blog/ipfs-crowdtesting/">crowd testing</a>. And as I said
before, super simple, just put this in the <code>snapcraft.yaml</code> file:</p>
<pre class="code literal-block"><span></span><span class="n">name</span><span class="o">:</span> <span class="n">gobot</span><span class="o">-</span><span class="n">blink</span><span class="o">-</span><span class="n">elopio</span>
<span class="n">version</span><span class="o">:</span> <span class="n">master</span>
<span class="n">summary</span><span class="o">:</span>  <span class="n">Blink</span> <span class="n">snap</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Raspberry</span> <span class="n">Pi</span> <span class="k">with</span> <span class="n">Gobot</span>
<span class="n">description</span><span class="o">:</span> <span class="o">|</span>
  <span class="n">This</span> <span class="k">is</span> <span class="n">a</span> <span class="n">simple</span> <span class="n">example</span> <span class="n">to</span> <span class="n">blink</span> <span class="n">an</span> <span class="n">LED</span> <span class="k">in</span> <span class="n">the</span> <span class="n">Raspberry</span> <span class="n">Pi</span>
  <span class="n">using</span> <span class="n">the</span> <span class="n">Gobot</span> <span class="n">framework</span><span class="o">.</span>

<span class="n">confinement</span><span class="o">:</span> <span class="n">devmode</span>

<span class="n">apps</span><span class="o">:</span>
  <span class="n">gobot</span><span class="o">-</span><span class="n">blink</span><span class="o">-</span><span class="n">elopio</span><span class="o">:</span>
    <span class="n">command</span><span class="o">:</span> <span class="n">gobot</span><span class="o">-</span><span class="n">blink</span>

<span class="n">parts</span><span class="o">:</span>
  <span class="n">gobot</span><span class="o">-</span><span class="n">blink</span><span class="o">:</span>
    <span class="n">source</span><span class="o">:</span> <span class="o">.</span>
    <span class="n">plugin</span><span class="o">:</span> <span class="n">go</span>
    <span class="n">go</span><span class="o">-</span><span class="n">importpath</span><span class="o">:</span> <span class="n">github</span><span class="o">.</span><span class="na">com</span><span class="sr">/elopio/g</span><span class="n">obot</span><span class="o">-</span><span class="n">blink</span>
</pre>


<p>To build the snap, here is a cool trick thanks to the work that
<a href="http://www.twotoasts.de/index.php/2017/06/how-to-support-cross-compilation-in-plugins/">kalikiana</a>
recently added to snapcraft. I'm writing this code in my development machine,
which is amd64. But the raspberry pi and beaglebone are armhf, and the
dragonboard is arm64; so I need to cross-compile the code to get binaries
for all the architectures:</p>
<pre class="code literal-block"><span></span>snapcraft --target-arch=armhf
snapcraft clean
snapcraft --target-arch=arm64
</pre>


<p>That will leave two .snap files in my working directory that then I can upload
to the store with <code>snapcraft push</code>. Or I can just push the code to GitHub and
let <a href="https://build.snapcraft.io">build.snapcraft.io</a> to take care of building
and pushing for me.</p>
<p>Here is the source code for this simple example:
<a href="https://github.com/elopio/gobot-blink">https://github.com/elopio/gobot-blink</a></p>
<p>Of course, Gobot supports many more devices that will let you build complex
robots. Just take a look at the
<a href="https://gobot.io/documentation/">documentation in the Gobot site</a>, and at the
<a href="https://gobot.io/documentation/guides/snapcraft/">guide about deployable packages with Gobot and snapcraft</a>.</p>
<p><a href="https://ia801502.us.archive.org/32/items/snappy-gobot/20170710_233319.ogv"><img alt="picture of the BeagleBone prototype" src="https://ia601502.us.archive.org/32/items/snappy-gobot/20170710_233317.jpg"></a></p>
<p>If you have one of the boards I'm using here to play, give it a try:</p>
<pre class="code literal-block"><span></span>sudo snap install gobot-blink-elopio --edge --devmode
sudo gobot-blink-elopio
</pre>


<p>Now my experiments will be to try make the snap more secure, with strict
confinement. If you have any questions or want to help, we have a
<a href="https://forum.snapcraft.io/t/write-your-robots-in-go-with-gobot-and-distribute-the-software-as-snaps/1086">topic in the forum</a>.</p>
</div>
    </div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/michijonesmaperespeis-costa-rica-55e4da8530cc/" class="u-url">#Maperespeis - Costa Rica</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/michijonesmaperespeis-costa-rica-55e4da8530cc/" rel="bookmark"><time class="published dt-published" datetime="2017-07-04T14:07:40-06:00" title="2017-07-04 14:07">2017-07-04 14:07</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <figure><img alt="" src="https://cdn-images-1.medium.com/max/301/1*f2VCzmQoUTxvN7xGk4Xvqg.png"></figure><p>Desde hace 2 años, que me uní al Jaquerespeis, tuve la oportunidad de aprender acerca de mapas abiertos, <a href="http://openstreetmap.org">OpenStreetMaps</a> y <a href="https://www.mapillary.com/">Mapillary</a>. Uno de las fortalezas del <a href="http://jaquerespeis.org/">Jaquerespeis</a> es el hecho de que es un grupo con un gran interés por los datos abiertos, información libre y que tiene mucha pasión por los proyectos que realizan. Otra fortaleza es el hecho de que <a href="https://twitter.com/yoelopio/status/850866539821662208">Leo Arias </a>(el embajador de Mapillary de Costa Rica) moviliza mucho las actividades y gracias a su contacto con Mapillary hemos conseguido productos para ayudar el mapeo del país. Un ejemplo de esto es la cámara 360.</p>
<p>El #Maperespeis es una oportunidad para reunirnos con mayor frecuencia, de realizar actividades, analizar los datos que se recolectaron , hacer un análisis de los mapas abiertos que existen y crear planes de trabajo para mejorar el estado en el cual se encuentran.</p>
<p>Descripción de los programas\herramientas que se utilizan:</p>
<p>Mapillary: Es una aplicación celular y web que permite recrear el entorno en 360 grados. Esta aplicación usa como base el OpenStreetMap, es gratis y se puede mapear en una gran variedad de celulares. Como a las grandes empresas no les interesa un mapeo de paises más pequeños, esta aplicación es una oportunidad que se puede aprovechar en cualquier país.</p>
<p>OpenStreetMap: Este es un programa de mapas libre que se lanzo a la web en el 2004. Este mapa es creado por voluntarios que colaboran para documentar el espacio donde se encuentran. Una ventaja muy grande de este mapa es que se puede descargar la base del mapa a un Sistema de Informacion Geográfico. Algunas iniciativas que trabajan con esto son: <a href="http://mapanica.net/">MapaNica</a>, <a href="http://si.cultura.cr/">SiCultura </a>(Costa Rica), <a href="http://tasks.hotosm.org/">OSMTasking Manager</a></p>
<p>Cámara 360 : Este tipo de camara permite grabar en 360 con cada imagen que guarda. Generalmente tiene dos lentes con gran alcance hacia las periferias. Estas imágenes luego se pueden subir a Mapillary.</p>
<p>Las reuniones se realizan de manera esporádica. Todo se notifica por el Facebook.</p>
<p>Vamos a mapear!!</p>
<img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=55e4da8530cc" width="1" height="1">
</div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/esblogtravis-snap-testing/" class="u-url">User acceptance testing of snaps, with Travis</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/esblogtravis-snap-testing/" rel="bookmark"><time class="published dt-published" datetime="2017-06-29T03:06:00-06:00" title="2017-06-29 03:06">2017-06-29 03:06</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p><a href="https://travis-ci.org/">Travis CI</a> offers a great continuous integration
service for the projects hosted on GitHub. With it, you can run tests, deliver
artifacts and deploy applications every time you push a commit, on pull requests, after they are merged, or with some other frequency.</p>
<p>Last week Travis CI
<a href="https://blog.travis-ci.com/2017-06-21-trusty-updates-2017-Q2-launch">updated the Ubuntu 14.04 (Trusty) machines</a>
that run your tests and deployment steps. This update came with a nice surprise for everybody
working to deliver software to Linux users, because it is now possible to
install <a href="https://snapcraft.io">snaps</a> in Travis!</p>
<p>I've been excited all week telling people about all the doors that this opens;
but if you have been following my adventures in the Ubuntu world, by now you
can probably guess that I'm mostly thinking about all the potential this has
for automated testing. For the automation of user acceptance tests.</p>
<p>User acceptance tests are executed from the point of view of the user, with
your software presented as a black box to them. The tests can only interact
with the software through the entry points you define for your users. If it's
a CLI application, then the tests will call commands and subcommands and check
the outputs. If it's a website or a desktop application, the tests will click
things, enter text and check the changes on this GUI. If it's a service with
an HTTP API, the tests will make requests and check the responses. On these
tests, the closer you can get to simulate the environment and behaviour of your
real users, the better.</p>
<p>Snaps are great for the automation of user acceptance tests because they are
immutable and they bundle all their dependencies. With this we can make sure
that your snap will work the same on any of the operating systems and
architectures that support snaps. The <a href="https://snapcraft.io/docs/core/snapd">snapd</a> service takes care of hiding
the differences and presenting a consistent execution environment for the snap.
So, getting a green execution of these tests in the Trusty machine of Travis is
a pretty good indication that it will work on all the active releases of
Ubuntu, Debian, Fedora and even on a Raspberry Pi.</p>
<p>Let me show you an example of what I'm talking about, obviously using my
favourite snap called IPFS. There is
<a href="http://elopio.net/blog/ipfs-crowdtesting/">more information about IPFS in my previous post</a>.</p>
<p>Check below the packaging metadata for the IPFS snap, a single <code>snapcraft.yaml</code>
file:</p>
<pre class="code literal-block"><span></span><span class="n">name</span><span class="o">:</span> <span class="n">ipfs</span>
<span class="n">version</span><span class="o">:</span> <span class="n">master</span>
<span class="n">summary</span><span class="o">:</span> <span class="n">global</span><span class="o">,</span> <span class="n">versioned</span><span class="o">,</span> <span class="n">peer</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">peer</span> <span class="n">filesystem</span>
<span class="n">description</span><span class="o">:</span> <span class="o">|</span>
  <span class="n">IPFS</span> <span class="n">combines</span> <span class="n">good</span> <span class="n">ideas</span> <span class="n">from</span> <span class="n">Git</span><span class="o">,</span> <span class="n">BitTorrent</span><span class="o">,</span> <span class="n">Kademlia</span><span class="o">,</span> <span class="n">SFS</span><span class="o">,</span> <span class="n">and</span> <span class="n">the</span> <span class="n">Web</span><span class="o">.</span>
  <span class="n">It</span> <span class="k">is</span> <span class="n">like</span> <span class="n">a</span> <span class="n">single</span> <span class="n">bittorrent</span> <span class="n">swarm</span><span class="o">,</span> <span class="n">exchanging</span> <span class="n">git</span> <span class="n">objects</span><span class="o">.</span> <span class="n">IPFS</span> <span class="n">provides</span>
  <span class="n">an</span> <span class="kd">interface</span> <span class="k">as</span> <span class="n">simple</span> <span class="k">as</span> <span class="n">the</span> <span class="n">HTTP</span> <span class="n">web</span><span class="o">,</span> <span class="n">but</span> <span class="k">with</span> <span class="n">permanence</span> <span class="n">built</span> <span class="k">in</span><span class="o">.</span> <span class="n">You</span>
  <span class="n">can</span> <span class="n">also</span> <span class="n">mount</span> <span class="n">the</span> <span class="n">world</span> <span class="n">at</span> <span class="o">/</span><span class="n">ipfs</span><span class="o">.</span>
<span class="n">confinement</span><span class="o">:</span> <span class="n">strict</span>

<span class="n">apps</span><span class="o">:</span>
  <span class="n">ipfs</span><span class="o">:</span>
    <span class="n">command</span><span class="o">:</span> <span class="n">ipfs</span>
    <span class="n">plugs</span><span class="o">:</span> <span class="o">[</span><span class="n">home</span><span class="o">,</span> <span class="n">network</span><span class="o">,</span> <span class="n">network</span><span class="o">-</span><span class="n">bind</span><span class="o">]</span>

<span class="n">parts</span><span class="o">:</span>
  <span class="n">ipfs</span><span class="o">:</span>
    <span class="n">source</span><span class="o">:</span> <span class="n">https</span><span class="o">://</span><span class="n">github</span><span class="o">.</span><span class="na">com</span><span class="sr">/ipfs/g</span><span class="n">o</span><span class="o">-</span><span class="n">ipfs</span><span class="o">.</span><span class="na">git</span>
    <span class="n">plugin</span><span class="o">:</span> <span class="n">nil</span>
    <span class="n">build</span><span class="o">-</span><span class="n">packages</span><span class="o">:</span> <span class="o">[</span><span class="n">make</span><span class="o">,</span> <span class="n">wget</span><span class="o">]</span>
    <span class="n">prepare</span><span class="o">:</span> <span class="o">|</span>
      <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="n">go</span><span class="sr">/src/github.com/ipfs/g</span><span class="n">o</span><span class="o">-</span><span class="n">ipfs</span>
      <span class="n">cp</span> <span class="o">-</span><span class="n">R</span> <span class="o">.</span> <span class="o">../</span><span class="n">go</span><span class="sr">/src/github.com/ipfs/g</span><span class="n">o</span><span class="o">-</span><span class="n">ipfs</span>
    <span class="n">build</span><span class="o">:</span> <span class="o">|</span>
      <span class="n">env</span> <span class="n">GOPATH</span><span class="o">=</span><span class="n">$</span><span class="o">(</span><span class="n">pwd</span><span class="o">)/../</span><span class="n">go</span> <span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="o">../</span><span class="n">go</span><span class="sr">/src/github.com/ipfs/g</span><span class="n">o</span><span class="o">-</span><span class="n">ipfs</span> <span class="n">install</span>
    <span class="n">install</span><span class="o">:</span> <span class="o">|</span>
      <span class="n">mkdir</span> <span class="n">$SNAPCRAFT_PART_INSTALL</span><span class="o">/</span><span class="n">bin</span>
      <span class="n">mv</span> <span class="o">../</span><span class="n">go</span><span class="sr">/bin/ipfs $SNAPCRAFT_PART_INSTALL/bin/</span>
    <span class="n">after</span><span class="o">:</span> <span class="o">[</span><span class="n">go</span><span class="o">]</span>
  <span class="n">go</span><span class="o">:</span>
    <span class="n">source</span><span class="o">-</span><span class="n">tag</span><span class="o">:</span> <span class="n">go1</span><span class="o">.</span><span class="mf">7.5</span>
</pre>


<p>It's not the most simple snap because they use their own build tool to get the
go dependencies and compile; but it's also not too complex. If you are new to
snaps and want to understand every detail of this file, or you want to package
your own project, the
<a href="https://tutorials.ubuntu.com/tutorial/create-first-snap">tutorial to create your first snap</a>
is a good place to start.</p>
<p>What's important here is that if you run <code>snapcraft</code> using the snapcraft.yaml file above, you
will get the IPFS snap. If you install that snap, then you can test it from the
point of view of the user. And if the tests work well, you can push it to the
edge channel of the Ubuntu store to start the crowdtesting with your community.</p>
<p>We can automate all of this with Travis. The <code>snapcraft.yaml</code> for the project
must be already in the GitHub repository, and we will add there a <code>.travis.yml</code>
file. They have
<a href="https://docs.travis-ci.com/">good docs to prepare your Travis account</a>.
First, let's see what's required to build the snap:</p>
<pre class="code literal-block"><span></span><span class="n">sudo</span><span class="o">:</span> <span class="n">required</span>
<span class="n">services</span><span class="o">:</span> <span class="o">[</span><span class="n">docker</span><span class="o">]</span>

<span class="n">script</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">v</span> <span class="n">$</span><span class="o">(</span><span class="n">pwd</span><span class="o">):</span><span class="n">$</span><span class="o">(</span><span class="n">pwd</span><span class="o">)</span> <span class="o">-</span><span class="n">w</span> <span class="n">$</span><span class="o">(</span><span class="n">pwd</span><span class="o">)</span> <span class="n">snapcore</span><span class="o">/</span><span class="n">snapcraft</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s2">"apt update &amp;&amp; snapcraft"</span>
</pre>


<p>For now, we build the snap in a docker container to keep things simple. We have
work in progress to be able to install snapcraft in Trusty as a snap, so soon
this will be even nicer running everything directly in the Travis machine.</p>
<p>This previous step will leave the packaged .snap file in the current directory.
So we can install it adding a few more steps to the Travis script:</p>
<pre class="code literal-block"><span></span><span class="k">[...]</span>

<span class="na">script:</span>
  <span class="na">- docker [...]</span>
  <span class="na">- sudo apt install --yes snapd</span>
  <span class="na">- sudo snap install *.snap --dangerous</span>
</pre>


<p>And once the snap is installed, we can run it and check that it works as expected.
Those checks are our automated user acceptance test. IPFS has a CLI
client, so we can just run commands and verify outputs with grep. Or we can get
fancier using <a href="https://github.com/kward/shunit2">shunit2</a> or
<a href="https://github.com/sstephenson/bats/">bats</a>. But the basic idea would be to
add to the Travis script something like this:</p>
<pre class="code literal-block"><span></span><span class="k">[...]</span>

<span class="na">script:</span>
  <span class="k">[...]</span>
  <span class="na">- /snap/bin/ipfs init</span>
  <span class="na">- /snap/bin/ipfs cat /ipfs/QmVLDAhCY3X9P2uRudKAryuQFPM5zqA3Yij1dY8FpGbL7T/readme | grep -z "^Hello and Welcome to IPFS!.*$"</span>
  <span class="na">- [...]</span>
</pre>


<p>If one of those checks fail, Travis will mark the execution as failed and stop
our release process until we fix them. If instead, all of the checks pass, then this version
is good enough to put into the store, where people can take it and run
exploratory tests to try to find problems caused by weird scenarios that we
missed in the automation. To help with that we have the
<code>snapcraft enable-ci travis</code> command, and a tutorial to guide you
step by step
<a href="https://tutorials.ubuntu.com/tutorial/continuous-snap-delivery-from-travis-ci#0">setting up the continuous delivery from Travis CI</a>.</p>
<p>For the IPFS snap we had for a long time a manual smoke suite, that our amazing
<a href="https://forum.snapcraft.io/t/call-for-testing-ipfs/97">community of testers</a>
have been executing over and over again, every time we want to publish a new
release. I've turned it into
<a href="https://github.com/elopio/ipfs-snap/blob/master/tests/smoke_test.sh">a simple bash script</a>
that from now on will be executed frequently by Travis, and will tell us if
there's something wrong before anybody gives it a try manually. With this our
community of testers will have more time to run new and interesting scenarios,
trying to break the application in clever ways, instead of running the same
repetitive steps many times.</p>
<p>Thanks to Travis and snapcraft we no longer have to worry about a big part of
or release process. Continuous integration and delivery can be fully automated,
and we will have to take a look only when something breaks.</p>
<p>As for IPFS, it will keep being my guinea pig to guide new features for
snapcraft and showcase them when ready. It has many more commands that
have to be added to the automated test suite, and it also has a web UI and
an HTTP API. Lots of things to play with! If you would like to help, and
on the way learn about snaps, automation and the decentralized web, please
let me know. You can take a look on my
<a href="https://github.com/elopio/ipfs-snap">IPFS snap repo</a> for more details about
testing snaps in Travis, and other tricks for the build and deployment.</p>
<p><a href="https://archive.org/download/elopio-screenshots2/travis/ipsf-travis.png"><img alt="screenshot of the IPFS smoke test running in travis" src="https://archive.org/download/elopio-screenshots2/travis/ipsf-travis.png"></a></p>
</div>
    </div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/michijonesmaperespeis6-ddfd8062b727/" class="u-url">#maperespeis6</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/michijonesmaperespeis6-ddfd8062b727/" rel="bookmark"><time class="published dt-published" datetime="2017-06-28T05:06:27-06:00" title="2017-06-28 05:06">2017-06-28 05:06</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <p>El 17 de junio del 2017, nos reunimos en el restaurante Manos en la Masa. Si no lo conocen lo recomiendo, comida rica, un espacio amplio para trabajar, internet rápido y un grupo de profesionales que atiende super atenta.</p>
<p>El propósito de esta reunión fue el de organizar la información recolectada en sesiones anteriores de Mapillary, llevadas a cabo en diferentes puntos del país. Estas actividades fueron desarrolladas por integrantes del Jaquerespeis y posteriormente, y de manera específica, por personas pertenecientes al Maperespeis.</p>
<p>Las actividades que recordamos haber realizado, hasta la fecha, y que trabajamos en ese día son las siguientes:</p>
<ul>
<li>Mapeo del parque la LibertadBares de Heredia</li>
<li>Bares de San José</li>
<li>Volcán Poás</li>
<li>Coronado</li>
<li>Bosque del niño</li>
</ul>
<p>Las acciones que se realizaron fueron: la revisión de las imágenes para agregar datos concretos que se ven en las imágenes pero que no salen en OpenStreetMap, la corrección de caminos en bosque y la digitalización de aspectos que aparecen en las imágenes aéreas y satelitales que no salen en OpenStreetMap.</p>
<p>De todas las tareas propuestas, se logró actualizar los mapas según los datos que se recolectaron en las sesiones de campo con el Mapillary. Algunas de las conversaciones de grupo, llevaron a analizar diferentes factores organizativos con el fin de mejorar el espacio en el cual trabajamos, como por ejemplo, celebrar reuniones periódicamente y de manera regular con el fin de asegurar que la información no se olvide; establecer cuál es el mejor medio para convocar a actividades (redes sociales o Telegram); y/o mejorar la sistematización del trabajo que se va desarrollando.</p>
<p>En total, logramos actualizar todos los datos de las salidas anteriores. En relación con el change set #maperespeis6 hay más de 805 cambios asociados.</p>
<p>Enlaces Útiles:</p>
<ul>
<li>Maperespeis <a href="https://www.facebook.com/maperespeis/?ref=br_rs">Facebook</a> Github</li>
<li>Jaquerespeis <a href="https://www.facebook.com/groups/jaquerespeis/?ref=br_rs">Facebook</a> <a href="http://jaquerespeis.org/">Sitio Web</a>
</li>
</ul>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*O30l8C8Vy3v4S1VJaL9K4Q.jpeg"></figure><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=ddfd8062b727" width="1" height="1">
</div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/manati-web-agencyhttps-medium-com-manati-web-agency-drupal-8-pseudo-fields-templates-and-rendering-images-with-links-8d02d083d2f/" class="u-url">Drupal 8: Pseudo fields, templates and rendering images with links.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/manati-web-agencyhttps-medium-com-manati-web-agency-drupal-8-pseudo-fields-templates-and-rendering-images-with-links-8d02d083d2f/" rel="bookmark"><time class="published dt-published" datetime="2017-05-23T16:05:01-06:00" title="2017-05-23 16:05">2017-05-23 16:05</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <figure><img alt="" src="https://cdn-images-1.medium.com/max/800/1*i9Lxf4RqvuJbLRf426cb0g.png"><figcaption>Illustration by <a href="https://medium.com/u/685ec9b9459c">Lucy Sánchez</a></figcaption></figure><p><em>Lea este artículo en español: </em><strong><em>Drupal 8</em>:</strong> <a href="https://medium.com/p/40870e35970e"><strong>Pseudocampos, templates y render de imágenes con links.</strong></a></p>
<p>A few days ago I started the development of a new Drupal 8 site. This site has come with a large set of interesting challenges because a lot of the required functionality is still not easy to implement. As of this moment, there are a lot of contrib modules that are in development, one of them is <a href="https://www.drupal.org/project/group"><em>group</em></a>.</p>
<p>Our client requires that every authenticated user can see the groups it belongs to directly from its profile. This feature is required to be done in such a way that you can see the group’s logo, and the logo has to be linked to that group page on the site. I researched alternatives with <em>views</em> and other contrib modules, but it didn’t bear fruit.</p>
<p>I opted for the custom approach: to create a pseudo field for the users. Such field would use a template in order to print the groups the user belongs to.</p>
<p><strong>Shoulders to the wheel!</strong></p>
<p>First we need to create a pseudo field. Let’s remember that pseudo fields are elements that, just like fields, we can manage from the admin interface of each entity, but the difference lies in that the element has only one function: to display information. Contrary to that, a field will store and show information entered by the users.</p>
<p>In Drupal 8 -like Drupal 7- we need to use 2 hooks to create our pseudo field for an entity: <em>hook_entity_extra_field_info()</em> and<em> hook_[ENTITY NAME]_view().</em></p>
<p><strong>hook_entity_extra_field_info().</strong></p>
<p>It tells the entity that there will be a new element available to display. For our case, we’ll implement it like so:</p>
<pre>/**<br> * Implements hook_entity_extra_field_info().<br> */<br>function my_module_entity_extra_field_info() {<br>  $extra = [];<br>  $extra['user']['user']['display']['my_mudule_active_subsites'] = array(<br>    'label' =&gt; new TranslatableMarkup('Active subsites'),<br>    'description' =&gt; new TranslatableMarkup('Show the current subscribed sites by one user'),<br>  );<br>  return $extra;<br>}</pre>
<p><strong>hook_[ENTITY NAME]_view()</strong></p>
<p>In this case, we’re interested in using <em>hook_user_view()</em> because we’re working with the user type entity. <em>hook_[ENTITY NAME]_view() </em>basically handles the display of each one of the elements of an entity. In this case, we’ll use it to format our pseudo field <em>my_mudule_active_subsites</em>.</p>
<p>For Drupal 8, the implementation of this hook varies a bit in the parameters it receives, we can find more documentation here:</p>
<p><a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Entity%21entity.api.php/function/hook_entity_view/8.2.x">https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Entity%21entity.api.php/function/hook_entity_view/8.2.x</a></p>
<pre>/**<br> * Implements hook_user_view().<br> */<br>function my_module_view(array &amp;$build, EntityInterface $entity, EntityViewDisplayInterface $display, $view_mode, $langcode) {<br>  if ($view_mode === 'full') {<br>    if ($display-&gt;getComponent('my_module_active_subsites')) {<br>      $groups = my_module_user_current_user_groups($entity);<br>      $groups_to_render = my_module_render_groups_images($groups);<br>      $build['my_module_user_active_subsites'] = [<br>        '#theme' =&gt; 'my_module_active_subsites',<br>        '#groups' =&gt; $groups_to_render,<br>      ];<br>    }<br>  }<br>}</pre>
<p>Like the example, we’re using the variable build that we get from the reference, to assign the value to show with our pseudo field. Notice that we created a new index inside the build array, which is a render array. Inside our index we’ll use #theme to indicate that we’re going to use a template, which we’ll define further down the road, and we’ll also use a variable called #groups, which is a variable inside our template.</p>
<p>Now, an important detail: like you can see in our example, we use 2 functions to obtain both the the groups of the user and the preprocessed data ready to be printed by Drupal. The function <em>my_module_user_current_user_groups() </em>basically returns an array of the entity type group, in which we wont delve. On the contrary, we’ll see the details of <em>my_module_render_groups_images()</em>.</p>
<h4>my_module_render_groups_images()</h4>
<p>This function was born because of our need to wrap the images in a link, specifically a link to the entity type group. We’ll solve that this way:</p>
<pre>/**<br> * Helper function to render the images with a specific image style.<br> *<br> * @param array $groups<br> *   The entity groups with the images to render.<br> */<br>function my_module_render_groups_images(array $groups) {<br>  $groups_to_render = [];<br>  foreach ($groups as $group) {<br>    $group_item = new Stdclass();<br>    $image_id = $group-&gt;field_site_logo-&gt;target_id;<br>    if (!empty($image_id)) {<br>      $image_render_array = [<br>        '#theme' =&gt; 'image_style',<br>        '#width' =&gt; $group-&gt;field_site_logo-&gt;width,<br>        '#height' =&gt; $group-&gt;field_site_logo-&gt;height,<br>        '#style_name' =&gt; 'site_logo_user_profile',<br>        '#uri' =&gt; $group-&gt;field_site_logo-&gt;entity-&gt;uri-&gt;value,<br>      ];<br>      $renderer = \Drupal::service('renderer');<br>      $renderer-&gt;addCacheableDependency($image_render_array, $group-&gt;field_site_logo-&gt;entity);<br>      $rendered_image = $renderer-&gt;render($image_render_array);<br>      $link_render_array = [<br>        '#type' =&gt; 'link',<br>        '#url' =&gt; Url::fromUri('entity:group/' . $group-&gt;id()),<br>        '#title' =&gt; $rendered_image,<br>      ];<br>      $group_item-&gt;logo = $link_render_array;<br>    }<br>    $groups_to_render[] = $group_item;<br>  }<br>  return $groups_to_render;<br>}</pre>
<p>As you can see in the example, what we do to print our image with a link is: first, prepare a render array to use the <em>image_style</em> template. After that, we use the service <em>renderer</em> from Drupal 8 (instead of Drupal_render from Drupal 7) to obtain an render type object, which will be assigned as a value for the <em>title</em> of our link.</p>
<p><strong>Defining our twig template</strong></p>
<p>Like Drupal 7, if we want to use our own templates inside a module, we need to define it, that is, make Drupal aware that such template exists. For that we’ll use <em>hook_theme()</em>.</p>
<pre>/**<br> * Implements hook_theme().<br> */<br>function my_module_user_theme($existing, $type, $theme, $path) {<br>  return [<br>    'my_module_user_active_subsites' =&gt; [<br>      'variables' =&gt; [<br>        'groups' =&gt; '',<br>      ],<br>    ],<br>  ];<br>}</pre>
<p><strong>Creating our template</strong></p>
<p>For our final step, we’ll proceed to create our twig template. In order to be recognized, our templates have to be placed in a specific location, with a specific naming convention.</p>
<p>Our templates have to be inside the folder called “templates” in the root of our module and like as I mentioned, have to follow the naming convention: template-name.html.twig. We’ll create the file <em>my-module-active-subsites.html.twig</em>.</p>
<p>This template will handle the format and will print the images belonging to our groups:</p>
<pre>{#<br>/**<br> * @file<br> * Template file my_module_active_subsites field<br> */<br>#}</pre>
<pre>&lt;div class="container user-groups-container"&gt;<br>   {% if groups is not empty %}<br>     {% for group in groups %}<br>        &lt;div class="container user-groups-element" &gt;<br>          {{ group.logo }}<br>        &lt;/div&gt;<br>     {% endfor %}<br>   {% endif %}<br>&lt;/div&gt;</pre>
<p>As you can see, Twig is very different from what we know before with PHP templates, but this does not mean is complicated. In my case, I used this documentation: <a href="https://www.drupal.org/docs/8/theming/twig/comparison-of-phptemplate-and-twig-theming-paradigms">https://www.drupal.org/docs/8/theming/twig/comparison-of-phptemplate-and-twig-theming-paradigms</a>, which is a comparative between what we used to do in PHP template and how we do it with Twig.</p>
<p>Pseudo fields in Drupal 8 -like in Drupal 7- are still a great resource that allows flexibility in the display of our entities. If we add templates in the mix, we can comply with any display requirement for our content. Just be aware that it depends on the type of display we need to use for our content.</p>
<p>Happy coding!</p>
<p><a href="https://www.estudiomanati.com"><strong><em>Manatí</em></strong></a><strong><em> is a web consultancy firm from Costa Rica</em></strong><em>, where we make websites strategically designed to help organization achieve goals.</em></p>
<p><em>Don’t miss out on projects, news and ideas from </em><a href="https://www.estudiomanati.com"><em>Manatí</em></a><em>. Learn about </em><a href="https://www.estudiomanati.com/what-we-do.html"><em>what we do</em></a><em>, follow us on </em><a href="https://medium.com/manati-web-agency"><strong><em>medium</em></strong></a><em>, </em><a href="https://twitter.com/estudiomanati"><strong><em>twitter</em></strong></a><em> and </em><a href="https://twitter.com/estudiomanati"><strong><em>facebook</em></strong></a><em>.</em></p>
<img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=8d02d083d2f" width="1" height="1"><hr>
<p><a href="https://medium.com/manati-web-agency/https-medium-com-manati-web-agency-drupal-8-pseudo-fields-templates-and-rendering-images-with-links-8d02d083d2f">Drupal 8: Pseudo fields, templates and rendering images with links.</a> was originally published in <a href="https://medium.com/manati-web-agency">MANATI | Agencia Web</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
    </div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/manati-web-agencydrupal-8-pseudocampos-templates-y-render-de-imc3a1genes-con-links-40870e35970e/" class="u-url">Drupal 8: Pseudocampos, templates y render de imágenes con links.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/manati-web-agencydrupal-8-pseudocampos-templates-y-render-de-imc3a1genes-con-links-40870e35970e/" rel="bookmark"><time class="published dt-published" datetime="2017-05-23T16:05:01-06:00" title="2017-05-23 16:05">2017-05-23 16:05</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <figure><img alt="" src="https://cdn-images-1.medium.com/max/800/1*i9Lxf4RqvuJbLRf426cb0g.png"><figcaption>Ilustración de <a href="https://medium.com/u/685ec9b9459c">Lucy Sánchez</a></figcaption></figure><p><em>Read this article in english:</em> <a href="https://medium.com/p/8d02d083d2f"><strong>Drupal 8: Pseudo fields, templates and rendering images with links</strong></a><strong>.</strong></p>
<p>Hace unos días atrás inicie el desarrollo de un nuevo sitio en Drupal 8. Este sitio ha llegado con una gran cantidad de retos interesantes puesto que muchas de las funcionalidades requeridas aún no son sencillas de implementar. En este momento hay muchos módulos <em>contrib que</em> aun se encuentran en desarrollo, uno de estos módulos es: <a href="https://www.drupal.org/project/group"><em>group</em></a>.</p>
<p>Nuestro cliente requiere que cada usuario autenticado pueda ver los grupos a los que pertenece directamente desde su perfil. Esta funcionalidad tiene que realizase de manera tal que se pudiera ver solamente el logo del grupo, y este logo debe estar enlazado a la página del sitio. Investigué para buscar alternativas con <em>views</em> u otros módulos contrib, pero la investigación no dio muchos frutos.</p>
<p>Opté por el desarrollo de algo <em>custom:</em> elegí desarrollar un pseudocampo para los usuarios. Dicho campo utilizará un <em>template</em> para imprimir dichos grupos.</p>
<h4>Manos a la obra.</h4>
<p>Primero necesitamos crear un pseudocampo. Recordemos que los pseudocampos son elementos que, al igual que un campo, podemos administrar desde la interfaz de despliegue de cada entidad, pero la diferencia radica en que este elemento solo tiene una función: mostrar información, a diferencia de un campo normal que muestra y almacena información brindada por los usuarios.</p>
<p>En drupal 8- como en drupal 7- necesitamos hacer uso de 2 hooks para hacer disponible nuestro pseudocampo para una entidad, estos son: <em>hook_entity_extra_field_info()</em> y<em> hook_[ENTITY NAME]_view().</em></p>
<h4>hook_entity_extra_field_info().</h4>
<p>Indica a la entidad que ahora va a existir un nuevo elemento disponible para su despliegue. Para nuestro caso lo implementamos de la siguiente manera:</p>
<pre>/**<br> * Implements hook_entity_extra_field_info().<br> */<br>function my_module_entity_extra_field_info() {<br>  $extra = [];<br>  $extra['user']['user']['display']['my_mudule_active_subsites'] = array(<br>    'label' =&gt; new TranslatableMarkup('Active subsites'),<br>    'description' =&gt; new TranslatableMarkup('Show the current subscribed sites by one user'),<br>  );<br>  return $extra;<br>}</pre>
<h4>hook_[ENTITY NAME]_view()</h4>
<p>En este caso nos interesa usar <em>hook_user_view() </em>porque que estamos trabajando con la entidad de tipo usuario. <em>hook_[ENTITY NAME]_view() </em>básicamente se encarga de manejar el despliegue de cada uno de los elementos de una entidad dada. En este caso lo vamos a utilizar para dar forma a nuestro pseudocampo <em>my_mudule_active_subsites.</em></p>
<p>Para drupal 8, la implementación de este hook varía un poco en los parámetros que recibe, podemos encontrar más documentación aquí: <a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Entity%21entity.api.php/function/hook_entity_view/8.2.x">https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Entity%21entity.api.php/function/hook_entity_view/8.2.x</a></p>
<pre>/**<br> * Implements hook_user_view().<br> */<br>function my_module_view(array &amp;$build, EntityInterface $entity, EntityViewDisplayInterface $display, $view_mode, $langcode) {<br>  if ($view_mode === 'full') {<br>    if ($display-&gt;getComponent('my_module_active_subsites')) {<br>      $groups = my_module_user_current_user_groups($entity);<br>      $groups_to_render = my_module_render_groups_images($groups);<br>      $build['my_module_user_active_subsites'] = [<br>        '#theme' =&gt; 'my_module_active_subsites',<br>        '#groups' =&gt; $groups_to_render,<br>      ];<br>    }<br>  }<br>}</pre>
<p>Como podemos ver en el ejemplo, estamos usando la variable build que nos llega por referencia para asignar a nuestro pseudocampo el valor a mostrar. Nótese que creamos un nuevo índice dentro del arreglo de build que es un arreglo de render. Dentro de nuestro índice usamos #theme para indicar que vamos a hacer uso de un template, el cual definiremos más adelante y también hacemos uso de #groups que es una variable propia de nuestro template.</p>
<p>Ahora, un detalle importante: como se puede apreciar en nuestro ejemplo, se hace uso de 2 funciones para obtener tanto los grupos del usuario como los datos preprocesados listos para ser impresos por drupal. La función <em>my_module_user_current_user_groups() </em>básicamente retorna un arreglo de entidades de tipo group, por lo cual no ahondaremos en ella. Por el contrario, sí entraremos en detalles con <em>my_module_render_groups_images().</em></p>
<h4><em>my_module_render_groups_images()</em></h4>
<p>Esta función nació por la necesidad de que nuestras imágenes estén envueltas en un link, específicamente, un enlace a la entidad de tipo grupo. Lo resolvemos de la siguiente manera:</p>
<pre>/**<br> * Helper function to render the images with a specific image style.<br> *<br> * <a href="http://twitter.com/param">@param</a> array $groups<br> *   The entity groups with the images to render.<br> */<br>function my_module_render_groups_images(array $groups) {<br>  $groups_to_render = [];<br>  foreach ($groups as $group) {<br>    $group_item = new Stdclass();<br>    $image_id = $group-&gt;field_site_logo-&gt;target_id;<br>    if (!empty($image_id)) {<br>      $image_render_array = [<br>        '#theme' =&gt; 'image_style',<br>        '#width' =&gt; $group-&gt;field_site_logo-&gt;width,<br>        '#height' =&gt; $group-&gt;field_site_logo-&gt;height,<br>        '#style_name' =&gt; 'site_logo_user_profile',<br>        '#uri' =&gt; $group-&gt;field_site_logo-&gt;entity-&gt;uri-&gt;value,<br>      ];<br>      $renderer = \Drupal::service('renderer');<br>      $renderer-&gt;addCacheableDependency($image_render_array, $group-&gt;field_site_logo-&gt;entity);<br>      $rendered_image = $renderer-&gt;render($image_render_array);<br>      $link_render_array = [<br>        '#type' =&gt; 'link',<br>        '#url' =&gt; Url::fromUri('entity:group/' . $group-&gt;id()),<br>        '#title' =&gt; $rendered_image,<br>      ];<br>      $group_item-&gt;logo = $link_render_array;<br>    }<br>    $groups_to_render[] = $group_item;<br>  }<br>  return $groups_to_render;<br>}</pre>
<p>Como se puede observar en el ejemplo, lo que realizamos para imprimir nuestra imagen con link, fue: primero preparar un arreglo de render para hacer uso del template de <em>image_style</em>. Luego usamos el servicio <em>renderer </em>de drupal 8 (remplazo de <em>drupal_render</em> en drupal 7) para obtener un objeto de tipo <em>renderer,</em> el cual posteriormente será asignado como valor para el <em>title</em> de nuestro link.</p>
<h4>Definiendo nuestro twig template.</h4>
<p>Al igual que en drupal 7, si queremos hacer uso de nuestro propio template en un módulo, debemos hacer la definición del mismo, osea, hacerle saber a Drupal que este template existe. Para esto hacemos uso del <em>hook_theme().</em></p>
<pre>/**<br> * Implements hook_theme().<br> */<br>function my_module_user_theme($existing, $type, $theme, $path) {<br>  return [<br>    'my_module_user_active_subsites' =&gt; [<br>      'variables' =&gt; [<br>        'groups' =&gt; '',<br>      ],<br>    ],<br>  ];<br>}</pre>
<h4>Creando nuestro template.</h4>
<p>Ahora, como paso final, procederemos a crear nuestro twig template. Para que nuestros templates sean reconocidos debemos colocarlos en una ubicación específica, siguiendo un formato de nombre específico.</p>
<p>Nuestros templates deben estar en una carpeta llamada “templates” en la raíz de nuestro módulo y como mencionamos, deben seguir el siguiente formato de nombre: nombre-template.html.twig. Para nuestro caso creamos el archivo: my-module-active-subsites.html.twig.</p>
<p>Este template se encargará de formatear e imprimir las imágenes pertenecientes a nuestros grupos:</p>
<pre>{#<br>/**<br> * <a href="http://twitter.com/file">@file</a><br> * Template file my_module_active_subsites field<br> */<br>#}</pre>
<pre>&lt;div class="container user-groups-container"&gt;<br>   {% if groups is not empty %}<br>     {% for group in groups %}<br>        &lt;div class="container user-groups-element" &gt;<br>          {{ group.logo }}<br>        &lt;/div&gt;<br>     {% endfor %}<br>   {% endif %}<br>&lt;/div&gt;</pre>
<p>Como podemos observar twig es muy distinto de lo que conocíamos antes en los PHP templates, pero esto no significa que sea complicado. En mi caso me apoyé en esta documentación: <a href="https://www.drupal.org/docs/8/theming/twig/comparison-of-phptemplate-and-twig-theming-paradigms">https://www.drupal.org/docs/8/theming/twig/comparison-of-phptemplate-and-twig-theming-paradigms,</a> esta documentación da una comparación entre lo que antes hacíamos con PHP templates y cómo se hace ahora con twig.</p>
<p>Como pudimos ver, los pseudocampos de Drupal 8 al igual que en Drupal 7, siguen siendo un gran recurso que permite dar flexibilidad a nuestros despliegues de entidades. Si a esto le unimos templates, podemos cumplir con cualquier requerimiento de despliegue de nuestro contenido. Solo se debe recordar que el uso de los mismos depende del tipo del despliegue que queramos usar para nuestro contenido.</p>
<p>¡Feliz codificación!</p>
<p><a href="https://www.estudiomanati.com/"><strong><em>Manatí</em></strong></a><strong><em> es una firma consultora web de origen costarricense</em></strong><em>, donde hacemos sitios estratégicamente diseñados para llevar organizaciones a lograr objetivos.</em></p>
<p><em>No se pierdan los proyectos, noticias e ideas de nosotros en Manatí. Conozca más sobre lo que hacemos, síganos en </em><a href="https://medium.com/manati-web-agency"><strong><em>medium</em></strong></a><em>, </em><a href="https://twitter.com/estudiomanati"><strong><em>twitter</em></strong></a><em> y </em><a href="https://twitter.com/estudiomanati"><strong><em>facebook</em></strong></a><em>.</em></p>
<img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=40870e35970e" width="1" height="1"><hr>
<p><a href="https://medium.com/manati-web-agency/drupal-8-pseudocampos-templates-y-render-de-im%C3%A1genes-con-links-40870e35970e">Drupal 8: Pseudocampos, templates y render de imágenes con links.</a> was originally published in <a href="https://medium.com/manati-web-agency">MANATI | Agencia Web</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/maperespeis-cantinas/" class="u-url">“Mapillaryando” en cantinas de San José</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/maperespeis-cantinas/" rel="bookmark"><time class="published dt-published" datetime="2017-05-16T12:18:31-06:00" title="2017-05-16 12:18">2017-05-16 12:18</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>-- por Marcia Ugarte y Joaquín Lizano</p>
<p>Un sábado por la tarde resultó ser el momento perfecto para que un grupo de personas se juntara en San José para iniciar la labor de contribuir al mapeo libre esta vez de cantinas del centro de la capital. Cantina en Costa Rica hace referencia a un bar popular, que posiblemente tenga sus añitos, sin aires snobs y que tiene alcohol y comida a buen precio, o solo alcohol.</p>
<p>Este grupo sacrificado trazó un plan de visita y mínimas normas para el proceso de mapeo: tomar máximo una cerveza en cada sitio y comer donde se pudiera ojalá una boca conocida del bar correspondiente. La ruta inició en El Gran Vicio, cantina de toda la vida dentro del Mercado Central; continuó al Ballestero, la única cantina que queda en una de las cuatro esquinas de entrada al San José de antaño y que dicen tiene uno de los mejores chifrijos; luego pasamos a La Embajada, bar chirrión con una barra larga larga y famoso por el gallo de chorizo; después le tocó al turno a El Faro, cantina de 3 pisos con hora feliz de cerveza a menos de mil colones y buena costilla; el siguiente fue La Bohemia, después Wongs y lxs últimxs valientes terminaron de madrugada en Area City.</p>
<p>Detallando el recorrido, el punto de inicio, “El Gran Vicio”, es probablemente una de las cantinas más viejas de San José. Ubicado en el Mercado Central de la ciudad, abrió sus puertas en 1880. Podríamos decir que es tan viejo que pareciera que es solo para hombres. El orinal está en una esquina del bar y la puerta no cierra ni abre, está como medio puesta y no resguarda aquella privacidad que se espera de un servicio sanitario. ¿Baño de mujeres? no hay. La pared opuesta a la barra de este espacio, que funciona como un pasillo debido a su estrechez, está llena de firmas, mensajes y memorias gráficas.</p>
<iframe width="640" height="480" src="https://embed-v1.mapillary.com/embed?version=1&amp;filter=%5B%22all%22%5D&amp;map_filter=%5B%22all%22%5D&amp;image_key=C_lJZW-k0qYNyz23N4q0-A&amp;client_id=WHJxWW40RWhyVGR6ajVEci1saHZNUTozZDQ5NjRmM2I4ZjBiNjc2&amp;style=photo" frameborder="0"></iframe>

<blockquote>
<ul>
<li>clientela que se conoce entre sí, algunos con sus uniformes de trabajo del mercado</li>
<li>el cantinero no era muy amable con los extraños (nosotros…)</li>
<li>es un bar de paso (paso a tomarme una cerveza y/o un trago y me voy)</li>
<li>interesante experiencia</li>
</ul>
</blockquote>
<p>De ahí partimos al “Ballestero”. Pocas cantinas tienen plantas naturales a la entrada. Seña que vamos por una experiencia diferente. Está situada en una de las esquinas del cierre de la calle ancha que da entrada a la ciudad capital desde el Norte. Desde la mesa de la esquina consumimos felices las bocas (dar fe que los patacones con frijoles son de lo mejor de la ciudad) mientras admiramos la bola disco de espejitos en el centro del techo (sin luces dirigidas, sin mecanismos para que gire), un antojo de los dueños para dar simbolismos fiesteros al lugar. Tal vez no combina la bola con la colección de vasos y las fotos familiares en la paredes, tal vez ese es justo el estilo que andaban buscando.</p>
<iframe width="640" height="480" src="https://embed-v1.mapillary.com/embed?version=1&amp;filter=%5B%22all%22%5D&amp;map_filter=%5B%22all%22%5D&amp;image_key=0Wdy1J_6R8u573dsK4W8ow&amp;client_id=WHJxWW40RWhyVGR6ajVEci1saHZNUTozZDQ5NjRmM2I4ZjBiNjc2&amp;style=photo" frameborder="0"></iframe>

<blockquote>
<ul>
<li>música texmex</li>
<li>chilera de la casa</li>
<li>tarjetas de crédito no bienvenidas (pero aceptadas si se insiste mucho)</li>
<li>mejor llevar cash</li>
</ul>
</blockquote>
<p>Debería haber también mención a los trayectos. Las caminatas de unxs jóvenes (y otros no tanto) caminando con sus celulares en posición horizontal y más arriba de sus cabezas, grabando el camino, siguiendo a su “líder” que camina con un báculo tecnológico con un ojo en las alturas. Digamos que no pasamos desapercibidxs por el público josefino. Posiblemente si unx nos viera pasar así de la nada… seguramente que tampoco sabría qué pensar… turistas, extraterrestres, geeks haciendo una peli/docu de chepe, buscando pokemones…?</p>
<p>El siguiente bar fue “La Embajada” que terminó siendo denominada la nueva embajada de Mapillary en Costa Rica. Su principal característica es la barra enorme que abarca gran parte del espacio y que da la impresión de que si nos animamos a llegar al final nos comerá la oscuridad, pero no. El fondo está repleto de mesas y hay suficiente espacio para todo el grupo y un mariachi que se acomoda al final de la barra. Realmente sorprende que exista un espacio tan grande y que fácilmente unx pase por fuera sin darse cuenta de lo que hay dentro.</p>
<iframe width="640" height="480" src="https://embed-v1.mapillary.com/embed?version=1&amp;filter=%5B%22all%22%5D&amp;map_filter=%5B%22all%22%5D&amp;image_key=o3exL2ctP3FsUdzqFZzqRg&amp;client_id=WHJxWW40RWhyVGR6ajVEci1saHZNUTozZDQ5NjRmM2I4ZjBiNjc2&amp;style=photo" frameborder="0"></iframe>

<blockquote>
<ul>
<li>la birra a 900 parece que era una publicidad vieja que no han eliminado. Costaba 1000</li>
<li>barra muy larga</li>
<li>los gallos de chorizo o salchichón vienen sin tortilla</li>
<li>mariachi compite con “música de cabina”</li>
<li>no se separan cuentas</li>
<li>muy concurrido</li>
</ul>
</blockquote>
<p>Seguimos el trayecto en un atardecer que afectaba, dada la cada vez menos luz, la posibilidad de mapear al caminar; pero “sacrificadamente” hicimos todo lo que estaba en nuestras manos para no frenar el mapeo. Caminamos por el puro centro de Chepe y llegamos al Faro. Una vieja edificación de tres pisos con vista al sur de San José. Ya cuan lejos logre ver unx desde este faro dependerá, entre otras cosas, de cuanto se enfieste en el lugar. Cada piso es un ambiente; de hecho, el tercer piso es para fiestas y no está abierto normalmente. Abajo estaba lleno por lo que fuimos al segundo piso, que además tenía un rock/pop ochentero apreciado por la mayoría del grupo. Las ventanas abiertas generaban un nivel de ventolero que, de querer enviajarse, podria referir al faro y ambientarse unx quien sabe donde.</p>
<iframe width="640" height="480" src="https://embed-v1.mapillary.com/embed?version=1&amp;filter=%5B%22all%22%5D&amp;map_filter=%5B%22all%22%5D&amp;image_key=WXetF2EpH5my8NQuZNGk_Q&amp;client_id=WHJxWW40RWhyVGR6ajVEci1saHZNUTozZDQ5NjRmM2I4ZjBiNjc2&amp;style=photo" frameborder="0"></iframe>

<blockquote>
<ul>
<li>buena atención</li>
<li>separan cuentas</li>
<li>aceptan tarjetas</li>
<li>distintos ambientes</li>
<li>buena música</li>
</ul>
</blockquote>
<p>Ya enrumbados (más de rumba que de rumbo) bajamos una cuadra y llegamos a La Bohemia. Cantina de tradición hasta para algunxs de lxs miembrxs del grupo mapeante.</p>
<iframe width="640" height="480" src="https://embed-v1.mapillary.com/embed?version=1&amp;filter=%5B%22all%22%5D&amp;map_filter=%5B%22all%22%5D&amp;image_key=61pGPoM6EurW4o6BjKsccQ&amp;client_id=WHJxWW40RWhyVGR6ajVEci1saHZNUTozZDQ5NjRmM2I4ZjBiNjc2&amp;style=photo" frameborder="0"></iframe>

<blockquote>
<ul>
<li>fácil sentirse bienvenidx en el lugar</li>
<li>fuerte conexión entre los clientes habituales</li>
<li>hasta nos regalaron del queque de un cumpleaños que estaban celebrando</li>
<li>pocas bocas</li>
<li>separan cuentas</li>
<li>aceptan tarjetas</li>
</ul>
</blockquote>
<p>Ya para esas horas de la noche, el trayecto se hacía inmapeable pero la intención sacrificada no se acababa. Fuimos a chequear otro par de lugares que podríamos incluir en futuras misiones. Wongs es un restaurante más que una cantina y en lugar de bocas fueron dumplings, generando un momento de excepción en la ruta. Terminamos en la madrugada del día siguiente en Area City celebrando ya un cumpleaños de alguien de nuestro grupo mapeante. Gran salida que, de seguir con ese espíritu festivo, puede generar muchxs sacrificadxs voluntarixs futurxs que nos permitan conocer más de esas cantinas tradicionales que aún quedan en San José.</p>
<p><a href="https://ia601502.us.archive.org/18/items/maperespeis-bares/san_jose/la_embajada/C87imwsUAAACDw7.jpglarge.jpeg"><img alt="La embajada de Mapillary en Costa Rica" src="https://ia601502.us.archive.org/18/items/maperespeis-bares/san_jose/la_embajada/C87imwsUAAACDw7.jpglarge.jpeg"></a></p>
</div>
    </div>
    </article><article class="h-entry post-"><header><h1 class="p-name entry-title"><a href="posts/postsminar-ethereum/" class="u-url">Minar ethereum</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                JáquerEspeis
            </span></p>
            <p class="dateline"><a href="posts/postsminar-ethereum/" rel="bookmark"><time class="published dt-published" datetime="2017-03-30T18:03:00-06:00" title="2017-03-30 18:03">2017-03-30 18:03</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<h2>Requerimientos</h2>
<ul>
<li>Minador</li>
<li>Ubuntu Server 16.04</li>
<li>Opcional(tarjeta de video)</li>
<li>Python y python-twisted</li>
<li>Ethereum</li>
<li>cpp-ethereum</li>
</ul>
<p><em><strong>NOTA:</strong> Se considera Ubuntu Server, en caso de Ubuntu Desktop algunos requerimientos ya vienen instalados en el sistema.</em></p>
<h2>Instalación</h2>
<ol>
<li>
<p>Instalar ubuntu 16.04</p>
</li>
<li>
<p>Instalar python y python-wisted</p>
</li>
</ol>
<pre class="code literal-block"><span></span>sudo apt-get install python
sudo apt-get install python-twisted
</pre>


<ol>
<li>Un vez que se tiene instalado el sistema operativo, activar el ppa de ethereum</li>
</ol>
<pre class="code literal-block"><span></span>sudo add-apt-repository ppa:ethereum/ethereum
sudo add-apt-repository ppa:ethereum/ethereum-qt
sudo add-apt-repository ppa:ethereum/ethereum-dev
sudo apt-get update
</pre>


<ol>
<li>Instalar ethereum</li>
</ol>
<pre class="code literal-block"><span></span>sudo apt-get install ethereum
</pre>


<ol>
<li>Instalar cpp-ethereum</li>
</ol>
<pre class="code literal-block"><span></span>sudo apt-get install cpp-ethereum
</pre>


<ol>
<li>
<p>Clonar el repositorio de <a href="https://github.com/Atrides/eth-proxy">eth-proxy</a>.</p>
</li>
<li>
<p>Crear un wallet con <a href="https://github.com/ethereum/go-ethereum/wiki/geth">geth</a> o <a href="https://github.com/paritytech/parity">parity</a>.</p>
</li>
<li>
<p>Instalar los drivers de vídeo, en el caso de usar una tarjeta de vídeo.</p>
</li>
<li>
<p>Modificar el archivo de configuración de eth-proxy para usar el wallet.</p>
</li>
<li>
<p>En el directorio eth-proxy, ejecutar <code>eth-proxy.py</code></p>
</li>
</ol>
<pre class="code literal-block"><span></span>sudo python eth-proxy/eth-proxy.py
</pre>


<ol>
<li>Ejecutar <code>ethminer</code> apuntando a localhost</li>
</ol>
<pre class="code literal-block"><span></span>ethminer -F http://127.0.0.1:8080/minador -G
</pre>


<p><em><strong>NOTA:</strong> La opción <code>-G</code> indica a ethminer que utilice GPU para minar, en caso de no contar con GPU utilice <code>--allow-opencl-cpu</code>.</em></p>
<h2>Referencias</h2>
<p>https://github.com/paritytech/parity
https://github.com/Atrides/eth-proxy
https://launchpad.net/~ethereum/+archive/ubuntu/ethereum
http://ethdocs.org/en/latest/ethereum-clients/cpp-ethereum/installing-binaries/linux-ubuntu-ppa.html</p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-2.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>Publicado bajo una licencia <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>. - Creado con <a href="https://getnikola.com" rel="nofollow">Nikola</a>
            
        </footer>
</div>
</div>


            <script src="../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
